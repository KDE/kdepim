kde4_header()

add_subdirectory( soap ) 
add_subdirectory( kioslave ) 

include_directories( ${KDE4_INCLUDE_DIR} ${QT_INCLUDES} ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_BINARY_DIR}  )


########### next target ###############

set(kcal_groupwise_LIB_SRCS 
   kcal_resourcegroupwise.cpp 
   kcal_resourcegroupwiseconfig.cpp 
   kcal_groupwiseprefs.cpp 
   groupwisesettingswidget.cpp 
   kcal_resourcegroupwise_plugin.cpp )

kde4_automoc(${kcal_groupwise_LIB_SRCS})

kde4_add_ui_files(kcal_groupwise_LIB_SRCS groupwisesettingswidgetbase.ui )

kde4_add_kcfg_files(kcal_groupwise_LIB_SRCS kcal_groupwiseprefsbase.kcfgc )

kde4_add_library(kcal_groupwise SHARED ${kcal_groupwise_LIB_SRCS})

target_link_libraries(kcal_groupwise  ${QT_AND_KDECORE_LIBS} gwsoap kcal kdepim kcal_groupwise )

set_target_properties(kcal_groupwise PROPERTIES VERSION 1.0.0 SOVERSION 1 )
install_targets(${LIB_INSTALL_DIR} kcal_groupwise )


########### next target ###############

set(kabc_groupwise_LIB_SRCS kabc_resourcegroupwise.cpp kabc_resourcegroupwiseconfig.cpp kabc_resourcegroupwise_plugin.cpp )

kde4_automoc(${kabc_groupwise_LIB_SRCS})

kde4_add_kcfg_files(kabc_groupwise_LIB_SRCS kabc_groupwiseprefs.kcfgc )

kde4_add_library(kabc_groupwise SHARED ${kabc_groupwise_LIB_SRCS})

target_link_libraries(kabc_groupwise  ${QT_AND_KDECORE_LIBS} gwsoap kcal kdepim kabc kabc_groupwise )

set_target_properties(kabc_groupwise PROPERTIES VERSION 1.0.0 SOVERSION 1 )
install_targets(${LIB_INSTALL_DIR} kabc_groupwise )


########### next target ###############

set(kcal_groupwise_PART_SRCS dummy.cpp )

kde4_automoc(${kcal_groupwise_PART_SRCS})

file(WRITE dummy.cpp "//autogenerated file by cmake\n")
kde4_add_plugin(kcal_groupwise ${kcal_groupwise_PART_SRCS})

kde4_install_libtool_file( ${PLUGIN_INSTALL_DIR} kcal_groupwise )

target_link_libraries(kcal_groupwise  ${QT_AND_KDECORE_LIBS} )

install_targets(${LIB_INSTALL_DIR}/kde4 kcal_groupwise )


########### next target ###############

set(kabc_groupwise_PART_SRCS dummy.cpp )

kde4_automoc(${kabc_groupwise_PART_SRCS})

file(WRITE dummy.cpp "//autogenerated file by cmake\n")
kde4_add_plugin(kabc_groupwise ${kabc_groupwise_PART_SRCS})

kde4_install_libtool_file( ${PLUGIN_INSTALL_DIR} kabc_groupwise )

target_link_libraries(kabc_groupwise  ${QT_AND_KDECORE_LIBS} )

install_targets(${LIB_INSTALL_DIR}/kde4 kabc_groupwise )


########### install files ###############

install_files( ${SERVICES_INSTALL_DIR}/kresources/kabc FILES kabc_groupwise.desktop )
install_files( ${SERVICES_INSTALL_DIR}/kresources/kcal FILES kcal_groupwise.desktop )

kde4_footer()



#original Makefile.am contents follow:

#SUBDIRS = soap kioslave
#
#INCLUDES = -I$(top_srcdir) $(all_includes)
#
#lib_LTLIBRARIES = libkcal_groupwise.la libkabc_groupwise.la
#
#libkcal_groupwise_la_SOURCES = kcal_resourcegroupwise.cpp \
#	kcal_resourcegroupwiseconfig.cpp kcal_groupwiseprefsbase.kcfgc kcal_groupwiseprefs.cpp \
#	groupwisesettingswidget.cpp groupwisesettingswidgetbase.ui
#libkcal_groupwise_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) \
#                               -version-info 1:0:0 -no-undefined
#libkcal_groupwise_la_LIBADD = soap/libgwsoap.la \
#                              $(top_builddir)/libkcal/libkcal.la \
#                              $(top_builddir)/libkdepim/libkdepim.la
#
#libkabc_groupwise_la_SOURCES = kabc_resourcegroupwise.cpp \
#                               kabc_resourcegroupwiseconfig.cpp \
#                               kabc_groupwiseprefs.kcfgc
#libkabc_groupwise_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) \
#                               -version-info 1:0:0 -no-undefined
#libkabc_groupwise_la_LIBADD = soap/libgwsoap.la \
#                              $(top_builddir)/libkcal/libkcal.la \
#                              $(top_builddir)/libkdepim/libkdepim.la \
#                              -lkabc
#
#
#kde_module_LTLIBRARIES = kcal_groupwise.la kabc_groupwise.la
#
#kcal_groupwise_la_SOURCES = kcal_resourcegroupwise_plugin.cpp
#kcal_groupwise_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
#kcal_groupwise_la_LIBADD = libkcal_groupwise.la
#
#kabc_groupwise_la_SOURCES = kabc_resourcegroupwise_plugin.cpp
#kabc_groupwise_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
#kabc_groupwise_la_LIBADD = libkabc_groupwise.la
#
#kcal_servicedir = $(kde_servicesdir)/kresources/kcal
#kcal_service_DATA = kcal_groupwise.desktop
#
#kabc_servicedir = $(kde_servicesdir)/kresources/kabc
#kabc_service_DATA = kabc_groupwise.desktop
#
#METASOURCES = AUTO
#
#messages: rc.cpp
#	$(XGETTEXT) *.cpp soap/*.cpp -o $(podir)/kres_groupwise.pot
#noinst_HEADERS = groupwisesettingswidget.h
