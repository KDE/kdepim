<HTML>
<HEAD>
<TITLE>The Empath book - Sending</TITLE>
</HEAD>
<H1>Sending</H1>

<H2>Introduction</H2>

<P>Empath uses what may at first seem a rather complex system for sending messages. As you look harder, you'll see it's actually deceptively simple, and has two advantages: It is fully asynchronous and completely safe.</P>

<P>Empath's MailSender class is your interface to mail sending. All communication should be done with the base class, not with derived classes such as EmpathMailSenderQmail</P>

<P>The class EmpathMailSender has a simple interface. You can either send or queue a message. These interface methods are also provided via the 'empath' macro.</P>
<P>You can call <TT>empath-&gt;send(RMM::RMessage)</TT> and forget about what happens. You don't need to know what mail sending objects are available and you don't need to worry about what happens to the message. These issues are dealt with by the Empath object and the MailSender base class respectively.</P>

<H2>The EmpathMailSender implementation.</H2>

<P>There are various possible async operations that can take place. They are
all tagged with different names.</P>

<TABLE ROWS=6 COLS=4 BORDER=1>
<TR>
<TD><EM>Tag</EM></TD>
<TD><EM>Circumstance</EM></TD>
<TD><EM>Success</EM></TD>
<TD><EM>Failure</EM></TD>
</TR>
<TR>
<TD><TT>message-&gt;pending</TT></TD>
<TD>An attempt has been made to put a message into the queue.</TD>
<TD>Send the message as soon as ready.</TD>
<TD>Inform the user that the message could not be queued. Tell them where the message has been saved for safekeeping.</TD>
</TR>
<TR>
<TD><TT>message-&gt;queue</TT></TD>
<TD>An attempt has been made to put a message into the queue.</TD>
<TD>Do nothing.</TD>
<TD>Inform the user that the message could not be queued.
Tell them where the message has been saved for safekeeping.</TD>
</TR>
<TR>
<TD><TT>message-&gt;send</TT></TD>
<TD>An attempt has been made to retrieve a message (from the queue) for sending.</TD>
<TD>Send the message as soon as ready.</TD>
<TD>Inform the user that a message that was queued for delivery
can now not be retrieved from the queue and that it may have been removed.</TD>
</TR>
<TR>
<TD><TT>queue-&gt;sent</TT></TD>
<TD>An attempt has been made to copy a message from the queue to the sent folder.</TD>
<TD>Remove the message from the queue.</TD>
<TD>Inform the user that a message in the queue can not be moved to the sent folder.</TD>
</TR>
<TR>
<TD><TT>queue-&gt;remove</TT></TD>
<TD>An attempt has been made to remove a message from the queue.</TD>
<TD>Do nothing.</TD>
<TD>Inform the user that a message in the queue could not be removed.</TD>
</TR>
</TABLE>


