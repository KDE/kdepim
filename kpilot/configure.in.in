dnl Check to see if pisock header and library are available

HAVE_PISOCK=1

AC_MSG_CHECKING(for libpisock)
libpisock_not_set=1
LIBPISOCK_PATH="."
dirs="/usr/include /usr/include/libpisock /usr/local/include/libpisock"
for i in $dirs ; do
    if test -r $i/pi-file.h; then
        LIBPISOCK_PATH="$i"
        AC_SUBST(LIBPISOCK_PATH)
        AC_MSG_RESULT(found)
        libpisock_not_set=0
        break
    fi
done

if test "libpisock_not_set" = "1" ; then
    HAVE_PISOCK=0
else
    ac_save_cppflags="$CPPFLAGS"
    CPPFLAGS="$CPPFLAGS -I$LIBPISOCK_PATH"
    AC_CHECK_HEADER(pi-file.h, , HAVE_PISOCK=0)
    CPPFLAGS="$ac_save_cppflags"
fi

AC_CHECK_LIB(pisock,
	pi_accept,
	[LIBPISOCK="-lpisock"], 
	[AC_CHECK_LIB(pisock,
		pi_accept,
		[LIBPISOCK="-lpisock -lxnet"],
		[AC_MSG_WARN([KPILOT: pisock library not found])
		HAVE_PISOCK=0])])
AC_SUBST(LIBPISOCK)

if test "$HAVE_PISOCK" = "0" ; then
  DO_NOT_COMPILE="$DO_NOT_COMPILE kpilot"
fi


